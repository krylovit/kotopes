<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ù–µ–π—Ä–æ—Å–µ—Ç—å-—Ç—Ä–µ–π–¥–µ—Ä Pro</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.21.0/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <style>
        /* –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –≤—Å–µ—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤ */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #0f172a;
            color: #e2e8f0;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            display: block;
        }

        /* –®–∞–ø–∫–∞ */
        .header {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 5px solid #3b82f6;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            margin: 0;
            color: #f1f5f9;
            font-size: 28px;
        }

        .header p {
            margin: 10px 0 0 0;
            color: #94a3b8;
            font-size: 14px;
        }

        /* –û—Å–Ω–æ–≤–Ω–∞—è —Ä–∞–∑–º–µ—Ç–∫–∞ */
        .main-layout {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        @media (max-width: 1200px) {
            .main-layout {
                flex-direction: column;
            }
        }

        .left-panel {
            width: 300px;
            min-width: 300px;
        }

        .right-panel {
            flex: 1;
            min-width: 0;
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∏ */
        .card {
            background: #1e293b;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid #334155;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .card-title {
            font-size: 18px;
            font-weight: 600;
            color: #f1f5f9;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #334155;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* –°—Ç–∞—Ç—É—Å */
        .status-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: #0f172a;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #334155;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .status-dot.active {
            background: #10b981;
            box-shadow: 0 0 10px #10b981;
        }

        .status-dot.paused {
            background: #f59e0b;
        }

        .status-dot.stopped {
            background: #ef4444;
        }

        /* –ö–Ω–æ–ø–∫–∏ */
        .btn {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.2s;
            width: 100%;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn:hover {
            background: #2563eb;
            transform: translateY(-1px);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn:disabled {
            background: #475569;
            cursor: not-allowed;
            transform: none;
        }

        .btn-success {
            background: #10b981;
        }

        .btn-success:hover {
            background: #059669;
        }

        .btn-danger {
            background: #ef4444;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .btn-secondary {
            background: #475569;
        }

        .btn-secondary:hover {
            background: #334155;
        }

        /* –§–æ—Ä–º—ã */
        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #94a3b8;
            font-size: 13px;
            font-weight: 500;
        }

        .form-group select,
        .form-group input {
            width: 100%;
            padding: 10px;
            border-radius: 6px;
            border: 1px solid #475569;
            background: #0f172a;
            color: #f1f5f9;
            font-size: 14px;
            box-sizing: border-box;
        }

        .form-group select:focus,
        .form-group input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);
        }

        /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .stat-item {
            background: #0f172a;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #3b82f6;
        }

        .stat-item.green {
            border-left-color: #10b981;
        }

        .stat-item.red {
            border-left-color: #ef4444;
        }

        .stat-item.blue {
            border-left-color: #3b82f6;
        }

        .stat-label {
            font-size: 12px;
            color: #94a3b8;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 22px;
            font-weight: 700;
            color: #f1f5f9;
        }

        /* –ì—Ä–∞—Ñ–∏–∫–∏ */
        .charts-container {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        @media (max-width: 1400px) {
            .charts-container {
                grid-template-columns: 1fr;
            }
        }

        .chart-wrapper {
            background: #1e293b;
            border-radius: 10px;
            padding: 20px;
            border: 1px solid #334155;
            height: 400px;
        }

        .chart-wrapper h3 {
            margin: 0 0 15px 0;
            color: #f1f5f9;
            font-size: 16px;
        }

        .chart-wrapper canvas {
            width: 100% !important;
            height: calc(100% - 30px) !important;
        }

        /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã */
        .indicators-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        .indicators-table th {
            background: #0f172a;
            padding: 12px;
            text-align: left;
            color: #94a3b8;
            font-weight: 600;
            border-bottom: 2px solid #334155;
            font-size: 13px;
        }

        .indicators-table td {
            padding: 10px 12px;
            border-bottom: 1px solid #334155;
            font-size: 13px;
        }

        .indicators-table tr:hover {
            background: rgba(255, 255, 255, 0.03);
        }

        /* –õ–æ–≥ */
        .log-container {
            background: #1e293b;
            border-radius: 10px;
            padding: 20px;
            border: 1px solid #334155;
            height: 300px;
            display: flex;
            flex-direction: column;
        }

        .log-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .log-content {
            flex: 1;
            overflow-y: auto;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 12px;
            line-height: 1.4;
        }

        .log-entry {
            padding: 8px 0;
            border-bottom: 1px solid #334155;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .log-time {
            color: #64748b;
            min-width: 70px;
        }

        .log-message {
            color: #e2e8f0;
        }

        .log-profit {
            color: #10b981;
        }

        .log-loss {
            color: #ef4444;
        }

        .log-warning {
            color: #f59e0b;
        }

        .log-info {
            color: #3b82f6;
        }

        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #1e293b;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            border-left: 4px solid #10b981;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            max-width: 350px;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.3s ease;
        }

        .notification.show {
            opacity: 1;
            transform: translateX(0);
        }

        .notification.warning {
            border-left-color: #f59e0b;
        }

        .notification.error {
            border-left-color: #ef4444;
        }

        /* –ó–∞–≥—Ä—É–∑—á–∏–∫ */
        .loader {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(15, 23, 42, 0.95);
            z-index: 9999;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .loader.active {
            display: flex;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(59, 130, 246, 0.2);
            border-top-color: #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* –ü—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä */
        .progress-bar {
            height: 6px;
            background: #334155;
            border-radius: 3px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
            border-radius: 3px;
            transition: width 0.3s;
        }

        /* –í–∫–ª–∞–¥–∫–∏ */
        .tabs {
            display: flex;
            background: #0f172a;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #334155;
            overflow: hidden;
        }

        .tab {
            flex: 1;
            padding: 12px;
            text-align: center;
            background: none;
            border: none;
            color: #94a3b8;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.2s;
        }

        .tab:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .tab.active {
            background: #1e293b;
            color: #3b82f6;
            box-shadow: inset 0 -3px 0 #3b82f6;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* –¢—É–ª—Ç–∏–ø—ã */
        .tooltip {
            position: relative;
            cursor: help;
        }

        .tooltip-text {
            visibility: hidden;
            position: absolute;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            background: #0f172a;
            color: #f1f5f9;
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid #334155;
            font-size: 12px;
            white-space: nowrap;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        /* –ü–ª–∞–≤–∞—é—â–∞—è –∫–Ω–æ–ø–∫–∞ */
        .floating-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: #3b82f6;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 24px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            z-index: 100;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .floating-btn:hover {
            background: #2563eb;
            transform: scale(1.1);
        }
    </style>
</head>
<body>
    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div id="notification" class="notification"></div>

    <!-- –ó–∞–≥—Ä—É–∑—á–∏–∫ -->
    <div id="loader" class="loader">
        <div class="spinner"></div>
        <div id="loaderText">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>

    <!-- –ü–ª–∞–≤–∞—é—â–∞—è –∫–Ω–æ–ø–∫–∞ -->
    <button id="scrollTopBtn" class="floating-btn" style="display: none;">‚Üë</button>

    <div class="container">
        <!-- –®–∞–ø–∫–∞ -->
        <div class="header">
            <h1>üß† –ù–µ–π—Ä–æ—Å–µ—Ç—å-—Ç—Ä–µ–π–¥–µ—Ä Pro</h1>
            <p>LSTM –Ω–µ–π—Ä–æ—Å–µ—Ç—å –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Ä—ã–Ω–∫–æ–≤. –û–±—É—á–µ–Ω–∏–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –¥–∞–Ω–Ω—ã—Ö Binance API.</p>
        </div>

        <!-- –°—Ç–∞—Ç—É—Å –±–∞—Ä -->
        <div class="status-bar">
            <div class="status-indicator">
                <span class="status-dot stopped" id="statusDot"></span>
                <span id="statusText">–û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ</span>
            </div>
            <div>
                <span id="sessionTimer">00:00:00</span>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∏ -->
        <div class="tabs">
            <button class="tab active" data-tab="dashboard">üìä –î–∞—à–±–æ—Ä–¥</button>
            <button class="tab" data-tab="model">üß† –ú–æ–¥–µ–ª—å</button>
            <button class="tab" data-tab="analytics">üìà –ê–Ω–∞–ª–∏—Ç–∏–∫–∞</button>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <div class="main-layout">
            <!-- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
            <div class="left-panel">
                <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ -->
                <div class="card">
                    <div class="card-title">
                        <span>‚öôÔ∏è</span> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                    </div>
                    <button id="startBtn" class="btn btn-success">
                        ‚ñ∂ –°—Ç–∞—Ä—Ç –æ–±—É—á–µ–Ω–∏—è
                    </button>
                    <button id="pauseBtn" class="btn" disabled>
                        ‚è∏ –ü–∞—É–∑–∞
                    </button>
                    <button id="saveBtn" class="btn btn-secondary">
                        üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                    </button>
                    <button id="loadBtn" class="btn btn-secondary">
                        üìÇ –ó–∞–≥—Ä—É–∑–∏—Ç—å
                    </button>
                    <button id="resetBtn" class="btn btn-danger">
                        üóëÔ∏è –°–±—Ä–æ—Å–∏—Ç—å
                    </button>
                </div>

                <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
                <div class="card">
                    <div class="card-title">
                        <span>üîß</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                    </div>
                    <div class="form-group">
                        <label>–¢–æ—Ä–≥–æ–≤–∞—è –ø–∞—Ä–∞</label>
                        <select id="symbolSelect">
                            <option value="BTCUSDT">BTC/USDT</option>
                            <option value="ETHUSDT">ETH/USDT</option>
                            <option value="SOLUSDT">SOL/USDT</option>
                            <option value="ADAUSDT">ADA/USDT</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>–¢–∞–π–º—Ñ—Ä–µ–π–º</label>
                        <select id="timeframeSelect">
                            <option value="1m">1 –º–∏–Ω—É—Ç–∞</option>
                            <option value="5m">5 –º–∏–Ω—É—Ç</option>
                            <option value="15m">15 –º–∏–Ω—É—Ç</option>
                            <option value="1h">1 —á–∞—Å</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>–†–∞–∑–º–µ—Ä —Å—Ç–∞–≤–∫–∏ (USDT)</label>
                        <input type="number" id="betSize" value="10" min="1" max="1000" step="1">
                    </div>
                    <div class="form-group">
                        <label>–†–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –æ–±—É—á–µ–Ω–∏—è</label>
                        <input type="number" id="lookback" value="50" min="10" max="200" step="10">
                    </div>
                    <div class="progress-bar">
                        <div id="trainingProgress" class="progress-fill" style="width: 0%"></div>
                    </div>
                </div>

                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
                <div class="card">
                    <div class="card-title">
                        <span>üìà</span> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                    </div>
                    <div class="stats-grid">
                        <div class="stat-item green">
                            <div class="stat-label">–ë–∞–ª–∞–Ω—Å</div>
                            <div class="stat-value" id="balanceValue">1000.00</div>
                        </div>
                        <div class="stat-item blue">
                            <div class="stat-label">–¢–æ—á–Ω–æ—Å—Ç—å</div>
                            <div class="stat-value" id="accuracyValue">-</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">–ü—Ä–æ–≥–Ω–æ–∑–æ–≤</div>
                            <div class="stat-value" id="predictionsCount">0</div>
                        </div>
                        <div class="stat-item red">
                            <div class="stat-label">–ü—Ä–∏–±—ã–ª—å</div>
                            <div class="stat-value" id="profitValue">+0.00</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å -->
            <div class="right-panel">
                <!-- –í–∫–ª–∞–¥–∫–∞ –î–∞—à–±–æ—Ä–¥ -->
                <div class="tab-content active" id="dashboard-tab">
                    <!-- –ì—Ä–∞—Ñ–∏–∫–∏ -->
                    <div class="charts-container">
                        <div class="chart-wrapper">
                            <h3>üìà –¶–µ–Ω–∞ –∏ –ø—Ä–æ–≥–Ω–æ–∑—ã</h3>
                            <canvas id="priceChart"></canvas>
                        </div>
                        <div class="chart-wrapper">
                            <h3>üí∞ –ë–∞–ª–∞–Ω—Å –Ω–µ–π—Ä–æ—Å–µ—Ç–∏</h3>
                            <canvas id="balanceChart"></canvas>
                        </div>
                    </div>

                    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã -->
                    <div class="card">
                        <div class="card-title">
                            <span>üîç</span> –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
                        </div>
                        <table class="indicators-table">
                            <thead>
                                <tr>
                                    <th>–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä</th>
                                    <th>–ó–Ω–∞—á–µ–Ω–∏–µ</th>
                                    <th>–°–∏–≥–Ω–∞–ª</th>
                                    <th>–¢–∞–π–º—Ñ—Ä–µ–π–º</th>
                                </tr>
                            </thead>
                            <tbody id="indicatorsBody">
                                <tr><td colspan="4">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</td></tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- –õ–æ–≥ -->
                    <div class="log-container">
                        <div class="log-header">
                            <div class="card-title" style="margin: 0;">
                                <span>üìù</span> –õ–æ–≥ —Ä–µ—à–µ–Ω–∏–π
                            </div>
                            <button id="clearLogBtn" class="btn-secondary" style="padding: 6px 12px; font-size: 12px;">
                                –û—á–∏—Å—Ç–∏—Ç—å
                            </button>
                        </div>
                        <div class="log-content" id="logContent">
                            <div class="log-entry">
                                <div class="log-time">--:--:--</div>
                                <div class="log-message log-info">–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞. –ù–∞–∂–º–∏—Ç–µ "–°—Ç–∞—Ä—Ç –æ–±—É—á–µ–Ω–∏—è"</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –í–∫–ª–∞–¥–∫–∞ –ú–æ–¥–µ–ª—å -->
                <div class="tab-content" id="model-tab">
                    <div class="card">
                        <div class="card-title">
                            <span>üß¨</span> –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ LSTM –º–æ–¥–µ–ª–∏
                        </div>
                        <div style="padding: 20px; background: #0f172a; border-radius: 8px; margin-bottom: 20px;">
                            <pre style="color: #94a3b8; font-family: monospace; font-size: 13px; margin: 0;">
LSTM Model Architecture:
‚îú‚îÄ‚îÄ Input Layer (50 timesteps √ó 8 features)
‚îú‚îÄ‚îÄ LSTM Layer 1 (64 units, dropout: 0.2)
‚îú‚îÄ‚îÄ LSTM Layer 2 (32 units, dropout: 0.2)
‚îú‚îÄ‚îÄ Dense Layer (16 units, ReLU)
‚îú‚îÄ‚îÄ Dropout Layer (0.3)
‚îú‚îÄ‚îÄ Dense Layer (8 units, ReLU)
‚îî‚îÄ‚îÄ Output Layer (1 unit, Sigmoid)

Total Parameters: ~25,000
Optimizer: Adam (lr=0.001)
Loss: Binary Crossentropy
                            </pre>
                        </div>
                        <button id="exportModelBtn" class="btn" style="width: auto; margin: 10px;">
                            üì§ –≠–∫—Å–ø–æ—Ä—Ç –º–æ–¥–µ–ª–∏
                        </button>
                        <button id="importModelBtn" class="btn btn-secondary" style="width: auto; margin: 10px;">
                            üì• –ò–º–ø–æ—Ä—Ç –º–æ–¥–µ–ª–∏
                        </button>
                    </div>
                </div>

                <!-- –í–∫–ª–∞–¥–∫–∞ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ -->
                <div class="tab-content" id="analytics-tab">
                    <div class="card">
                        <div class="card-title">
                            <span>üìä</span> –î–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
                        </div>
                        <div class="charts-container">
                            <div class="chart-wrapper">
                                <h3>üéØ –ò—Å—Ç–æ—Ä–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏</h3>
                                <canvas id="accuracyChart"></canvas>
                            </div>
                            <div class="chart-wrapper">
                                <h3>üìâ –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤</h3>
                                <canvas id="distributionChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ====================
        const CONFIG = {
            INITIAL_BALANCE: 1000.0,
            DEFAULT_BET: 10,
            LOOKBACK: 50,
            UPDATE_INTERVAL: 30000, // 30 —Å–µ–∫—É–Ω–¥ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            API_URL: 'https://api.binance.com/api/v3/klines',
            FEATURES: 8, // –£–º–µ–Ω—å—à–∏–ª –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
            MODEL_KEY: 'neuro_trader_lstm_model_v3'
        };

        // ==================== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ====================
        let model = null;
        let charts = {};
        let state = {
            status: 'stopped', // 'running', 'paused', 'stopped'
            balance: CONFIG.INITIAL_BALANCE,
            predictions: [],
            priceData: [],
            balanceHistory: [{time: Date.now(), balance: CONFIG.INITIAL_BALANCE}],
            accuracyHistory: [],
            sessionStart: null,
            indicators: {},
            lastPrediction: null
        };

        // ==================== –£–¢–ò–õ–ò–¢–´ ====================
        function showNotification(message, type = 'info', duration = 3000) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            
            setTimeout(() => notification.classList.remove('show'), duration);
        }

        function showLoader(show, text = '–ó–∞–≥—Ä—É–∑–∫–∞...') {
            const loader = document.getElementById('loader');
            const loaderText = document.getElementById('loaderText');
            
            if (show) {
                loaderText.textContent = text;
                loader.classList.add('active');
            } else {
                loader.classList.remove('active');
            }
        }

        function addLog(message, type = 'info') {
            const logContent = document.getElementById('logContent');
            const time = new Date().toLocaleTimeString();
            
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.innerHTML = `
                <div class="log-time">${time}</div>
                <div class="log-message log-${type}">${message}</div>
            `;
            
            logContent.prepend(entry);
            
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –ª–æ–≥
            if (logContent.children.length > 50) {
                logContent.removeChild(logContent.lastChild);
            }
            
            // –ê–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫–∞
            logContent.scrollTop = 0;
        }

        // ==================== –ò–ù–î–ò–ö–ê–¢–û–†–´ ====================
        function calculateIndicators(data) {
            if (data.length < 20) return data;
            
            // SMA 7
            for (let i = 6; i < data.length; i++) {
                let sum = 0;
                for (let j = i-6; j <= i; j++) sum += data[j].close;
                data[i].sma7 = sum / 7;
            }
            
            // RSI
            for (let i = 14; i < data.length; i++) {
                let gains = 0, losses = 0;
                for (let j = i-13; j <= i; j++) {
                    const change = data[j].close - data[j-1].close;
                    if (change > 0) gains += change;
                    else losses += Math.abs(change);
                }
                const avgGain = gains / 14;
                const avgLoss = losses / 14;
                data[i].rsi = avgLoss === 0 ? 100 : 100 - (100 / (1 + avgGain / avgLoss));
            }
            
            // –ü—Ä–æ—Å—Ç–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ
            for (let i = 1; i < data.length; i++) {
                data[i].change = ((data[i].close - data[i-1].close) / data[i-1].close) * 100;
            }
            
            return data;
        }

        // ==================== LSTM –ú–û–î–ï–õ–¨ ====================
        async function createModel() {
            showLoader(true, '–°–æ–∑–¥–∞–Ω–∏–µ LSTM –º–æ–¥–µ–ª–∏...');
            
            try {
                const model = tf.sequential();
                
                // –ü–µ—Ä–≤—ã–π LSTM —Å–ª–æ–π
                model.add(tf.layers.lstm({
                    units: 64,
                    inputShape: [CONFIG.LOOKBACK, CONFIG.FEATURES],
                    returnSequences: true
                }));
                
                // –í—Ç–æ—Ä–æ–π LSTM —Å–ª–æ–π
                model.add(tf.layers.lstm({
                    units: 32
                }));
                
                // Dense —Å–ª–æ–∏
                model.add(tf.layers.dense({units: 16, activation: 'relu'}));
                model.add(tf.layers.dropout({rate: 0.3}));
                model.add(tf.layers.dense({units: 8, activation: 'relu'}));
                
                // –í—ã—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π
                model.add(tf.layers.dense({units: 1, activation: 'sigmoid'}));
                
                // –ö–æ–º–ø–∏–ª—è—Ü–∏—è
                model.compile({
                    optimizer: tf.train.adam(0.001),
                    loss: 'binaryCrossentropy',
                    metrics: ['accuracy']
                });
                
                console.log('–ú–æ–¥–µ–ª—å —Å–æ–∑–¥–∞–Ω–∞');
                addLog('LSTM –º–æ–¥–µ–ª—å —Å–æ–∑–¥–∞–Ω–∞ —É—Å–ø–µ—à–Ω–æ', 'info');
                return model;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–¥–µ–ª–∏:', error);
                addLog('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–¥–µ–ª–∏', 'warning');
                return null;
            } finally {
                showLoader(false);
            }
        }

        // ==================== –†–ê–ë–û–¢–ê –° –î–ê–ù–ù–´–ú–ò ====================
        async function fetchData(symbol, interval, limit = 100) {
            try {
                const url = `${CONFIG.API_URL}?symbol=${symbol}&interval=${interval}&limit=${limit}`;
                const response = await fetch(url);
                
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                
                const klines = await response.json();
                
                return klines.map(k => ({
                    time: parseInt(k[0]),
                    open: parseFloat(k[1]),
                    high: parseFloat(k[2]),
                    low: parseFloat(k[3]),
                    close: parseFloat(k[4]),
                    volume: parseFloat(k[5])
                }));
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
                addLog(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${error.message}`, 'warning');
                return null;
            }
        }

        function prepareInput(data) {
            if (data.length < CONFIG.LOOKBACK) return null;
            
            const sequence = data.slice(-CONFIG.LOOKBACK);
            const features = sequence.map(candle => [
                candle.close / 100000,        // –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Ü–µ–Ω–∞
                candle.volume / 1000000,      // –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –æ–±—ä–µ–º
                (candle.sma7 || candle.close) / 100000,
                (candle.rsi || 50) / 100,     // RSI –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω
                candle.change ? candle.change / 10 : 0, // –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã
                Math.random() * 0.1,          // –®—É–º –¥–ª—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è
                0, 0                          // –†–µ–∑–µ—Ä–≤
            ]);
            
            return tf.tensor3d([features]);
        }

        // ==================== –û–ë–£–ß–ï–ù–ò–ï –ò –ü–†–û–ì–ù–û–ó ====================
        async function makePrediction() {
            if (!model || state.priceData.length < CONFIG.LOOKBACK) return null;
            
            try {
                const input = prepareInput(state.priceData);
                if (!input) return null;
                
                const prediction = model.predict(input);
                const probability = (await prediction.data())[0];
                
                const currentPrice = state.priceData[state.priceData.length - 1].close;
                
                input.dispose();
                prediction.dispose();
                
                return {
                    time: Date.now(),
                    price: currentPrice,
                    probability,
                    decision: probability > 0.5 ? 'BUY' : 'SELL',
                    result: null
                };
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≥–Ω–æ–∑–∞:', error);
                return null;
            }
        }

        // ==================== –û–°–ù–û–í–ù–û–ô –¶–ò–ö–õ ====================
        async function mainLoop() {
            if (state.status !== 'running') return;
            
            try {
                const symbol = document.getElementById('symbolSelect').value;
                const interval = document.getElementById('timeframeSelect').value;
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
                const newData = await fetchData(symbol, interval, 10);
                if (!newData || newData.length === 0) {
                    setTimeout(mainLoop, CONFIG.UPDATE_INTERVAL);
                    return;
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
                for (const candle of newData) {
                    const exists = state.priceData.find(d => d.time === candle.time);
                    if (!exists) {
                        state.priceData.push(candle);
                    }
                }
                
                // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä
                if (state.priceData.length > 200) {
                    state.priceData = state.priceData.slice(-200);
                }
                
                // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
                state.priceData = calculateIndicators(state.priceData);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –≤ —Ç–∞–±–ª–∏—Ü–µ
                updateIndicatorsTable();
                
                // –î–µ–ª–∞–µ–º –ø—Ä–æ–≥–Ω–æ–∑
                if (state.priceData.length >= CONFIG.LOOKBACK) {
                    const prediction = await makePrediction();
                    
                    if (prediction) {
                        state.lastPrediction = prediction;
                        
                        // –ñ–¥–µ–º —Å–ª–µ–¥—É—é—â—É—é —Å–≤–µ—á—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
                        setTimeout(async () => {
                            const checkData = await fetchData(symbol, interval, 1);
                            if (checkData && checkData.length > 0) {
                                const actualPrice = checkData[0].close;
                                evaluatePrediction(prediction, actualPrice);
                                updateCharts();
                                updateUI();
                            }
                        }, 5000);
                    }
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –≥—Ä–∞—Ñ–∏–∫–∏
                updateCharts();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º UI
                updateUI();
                
                // –°–ª–µ–¥—É—é—â–∏–π —Ü–∏–∫–ª
                setTimeout(mainLoop, CONFIG.UPDATE_INTERVAL);
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≤ —Ü–∏–∫–ª–µ:', error);
                setTimeout(mainLoop, CONFIG.UPDATE_INTERVAL);
            }
        }

        function evaluatePrediction(prediction, actualPrice) {
            const betSize = parseFloat(document.getElementById('betSize').value) || CONFIG.DEFAULT_BET;
            const priceChange = actualPrice - prediction.price;
            
            let isCorrect = false;
            if (prediction.decision === 'BUY' && priceChange > 0) isCorrect = true;
            if (prediction.decision === 'SELL' && priceChange < 0) isCorrect = true;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å
            if (isCorrect) {
                state.balance += betSize * 0.95;
            } else {
                state.balance -= betSize;
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            prediction.result = {
                actualPrice,
                isCorrect,
                profit: isCorrect ? betSize * 0.95 : -betSize,
                time: Date.now()
            };
            
            state.predictions.push(prediction);
            state.balanceHistory.push({
                time: Date.now(),
                balance: state.balance
            });
            
            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ç–æ—á–Ω–æ—Å—Ç—å
            const recent = state.predictions.slice(-100);
            const correct = recent.filter(p => p.result && p.result.isCorrect).length;
            const accuracy = recent.length > 0 ? (correct / recent.length) * 100 : 0;
            
            state.accuracyHistory.push({
                time: Date.now(),
                accuracy
            });
            
            // –õ–æ–≥–∏—Ä—É–µ–º
            const logMsg = `–ü—Ä–æ–≥–Ω–æ–∑: ${prediction.decision} (${(prediction.probability*100).toFixed(1)}%) | ` +
                          `–¶–µ–Ω–∞: ${prediction.price.toFixed(2)} ‚Üí ${actualPrice.toFixed(2)} | ` +
                          `–†–µ–∑—É–ª—å—Ç–∞—Ç: ${isCorrect ? '‚úÖ' : '‚ùå'} | ` +
                          `–ë–∞–ª–∞–Ω—Å: ${state.balance.toFixed(2)} USDT`;
            
            addLog(logMsg, isCorrect ? 'profit' : 'loss');
        }

        // ==================== –û–ë–ù–û–í–õ–ï–ù–ò–ï –ò–ù–¢–ï–†–§–ï–ô–°–ê ====================
        function updateUI() {
            // –°—Ç–∞—Ç—É—Å
            const statusDot = document.getElementById('statusDot');
            const statusText = document.getElementById('statusText');
            
            statusDot.className = 'status-dot ' + state.status;
            statusText.textContent = 
                state.status === 'running' ? '–û–±—É—á–µ–Ω–∏–µ' :
                state.status === 'paused' ? '–ü–∞—É–∑–∞' : '–û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ';
            
            // –ë–∞–ª–∞–Ω—Å –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            document.getElementById('balanceValue').textContent = state.balance.toFixed(2);
            
            const profit = state.balance - CONFIG.INITIAL_BALANCE;
            document.getElementById('profitValue').textContent = (profit >= 0 ? '+' : '') + profit.toFixed(2);
            document.getElementById('profitValue').parentElement.className = 
                'stat-item ' + (profit >= 0 ? 'green' : 'red');
            
            document.getElementById('predictionsCount').textContent = state.predictions.length;
            
            // –¢–æ—á–Ω–æ—Å—Ç—å
            const recent = state.predictions.slice(-100);
            const correct = recent.filter(p => p.result && p.result.isCorrect).length;
            const accuracy = recent.length > 0 ? (correct / recent.length) * 100 : 0;
            document.getElementById('accuracyValue').textContent = accuracy.toFixed(1) + '%';
            
            // –¢–∞–π–º–µ—Ä —Å–µ—Å—Å–∏–∏
            if (state.sessionStart) {
                const elapsed = Date.now() - state.sessionStart;
                const hours = Math.floor(elapsed / 3600000);
                const minutes = Math.floor((elapsed % 3600000) / 60000);
                const seconds = Math.floor((elapsed % 60000) / 1000);
                document.getElementById('sessionTimer').textContent = 
                    `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
            
            // –ü—Ä–æ–≥—Ä–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è
            const progress = Math.min(state.predictions.length / 100 * 100, 100);
            document.getElementById('trainingProgress').style.width = progress + '%';
        }

        function updateIndicatorsTable() {
            if (state.priceData.length === 0) return;
            
            const last = state.priceData[state.priceData.length - 1];
            const table = document.getElementById('indicatorsBody');
            
            const indicators = [
                {name: '–¶–µ–Ω–∞', value: last.close.toFixed(2), signal: '‚Äî', timeframe: '–¢–µ–∫—É—â–∞—è'},
                {name: '–û–±—ä–µ–º', value: (last.volume / 1000).toFixed(1) + 'K', signal: last.volume > 1000000 ? '–í—ã—Å–æ–∫–∏–π' : '–ù–∏–∑–∫–∏–π', timeframe: '24—á'},
                {name: 'RSI', value: last.rsi ? last.rsi.toFixed(1) : '‚Äî', signal: last.rsi > 70 ? '–ü–µ—Ä–µ–∫—É–ø–ª–µ–Ω' : last.rsi < 30 ? '–ü–µ—Ä–µ–ø—Ä–æ–¥–∞–Ω' : '–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ', timeframe: '14'},
                {name: 'SMA 7', value: last.sma7 ? last.sma7.toFixed(2) : '‚Äî', signal: last.close > last.sma7 ? '–ë—ã—á–∏–π' : '–ú–µ–¥–≤–µ–∂–∏–π', timeframe: '7'},
                {name: '–ò–∑–º–µ–Ω–µ–Ω–∏–µ', value: last.change ? last.change.toFixed(2) + '%' : '‚Äî', signal: last.change > 0 ? '–†–æ—Å—Ç' : '–ü–∞–¥–µ–Ω–∏–µ', timeframe: '1'},
                {name: '–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å', value: '‚Äî', signal: '–°—Ä–µ–¥–Ω—è—è', timeframe: '24—á'},
                {name: '–¢–æ—á–Ω–æ—Å—Ç—å –ù–°', value: state.accuracyHistory.length > 0 ? state.accuracyHistory[state.accuracyHistory.length-1].accuracy.toFixed(1) + '%' : '‚Äî', signal: '–û–±—É—á–µ–Ω–∏–µ', timeframe: '100'},
                {name: '–ë–∞–ª–∞–Ω—Å –ù–°', value: state.balance.toFixed(0), signal: state.balance > CONFIG.INITIAL_BALANCE ? '–ü—Ä–∏–±—ã–ª—å' : '–£–±—ã—Ç–æ–∫', timeframe: '–°–µ—Å—Å–∏—è'}
            ];
            
            let html = '';
            indicators.forEach(ind => {
                html += `
                    <tr>
                        <td>${ind.name}</td>
                        <td>${ind.value}</td>
                        <td>${ind.signal}</td>
                        <td>${ind.timeframe}</td>
                    </tr>
                `;
            });
            
            table.innerHTML = html;
        }

        // ==================== –ì–†–ê–§–ò–ö–ò ====================
        function updateCharts() {
            // –ì—Ä–∞—Ñ–∏–∫ —Ü–µ–Ω—ã
            if (state.priceData.length > 0) {
                const priceCtx = document.getElementById('priceChart').getContext('2d');
                const labels = state.priceData.slice(-50).map(d => 
                    new Date(d.time).toLocaleTimeString([], {hour: '2-digit', minute: '2-digit'})
                );
                const prices = state.priceData.slice(-50).map(d => d.close);
                
                if (!charts.price) {
                    charts.price = new Chart(priceCtx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: '–¶–µ–Ω–∞',
                                data: prices,
                                borderColor: '#3b82f6',
                                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                borderWidth: 2,
                                fill: true,
                                tension: 0.4
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { display: false }
                            },
                            scales: {
                                x: { 
                                    grid: { color: 'rgba(255,255,255,0.1)' },
                                    ticks: { color: '#94a3b8', maxRotation: 0 }
                                },
                                y: {
                                    grid: { color: 'rgba(255,255,255,0.1)' },
                                    ticks: { color: '#94a3b8' }
                                }
                            }
                        }
                    });
                } else {
                    charts.price.data.labels = labels;
                    charts.price.data.datasets[0].data = prices;
                    charts.price.update('none');
                }
            }
            
            // –ì—Ä–∞—Ñ–∏–∫ –±–∞–ª–∞–Ω—Å–∞
            if (state.balanceHistory.length > 0) {
                const balanceCtx = document.getElementById('balanceChart').getContext('2d');
                const labels = state.balanceHistory.slice(-50).map(d => 
                    new Date(d.time).toLocaleTimeString([], {hour: '2-digit', minute: '2-digit'})
                );
                const balances = state.balanceHistory.slice(-50).map(d => d.balance);
                
                if (!charts.balance) {
                    charts.balance = new Chart(balanceCtx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: '–ë–∞–ª–∞–Ω—Å',
                                data: balances,
                                borderColor: '#10b981',
                                backgroundColor: 'rgba(16, 185, 129, 0.1)',
                                borderWidth: 2,
                                fill: true,
                                tension: 0.4
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { display: false }
                            },
                            scales: {
                                x: { display: false },
                                y: {
                                    grid: { color: 'rgba(255,255,255,0.1)' },
                                    ticks: { color: '#94a3b8' }
                                }
                            }
                        }
                    });
                } else {
                    charts.balance.data.labels = labels;
                    charts.balance.data.datasets[0].data = balances;
                    charts.balance.update('none');
                }
            }
            
            // –ì—Ä–∞—Ñ–∏–∫ —Ç–æ—á–Ω–æ—Å—Ç–∏
            if (state.accuracyHistory.length > 0) {
                const accuracyCtx = document.getElementById('accuracyChart').getContext('2d');
                const labels = state.accuracyHistory.slice(-50).map(d => 
                    new Date(d.time).toLocaleTimeString([], {hour: '2-digit', minute: '2-digit'})
                );
                const accuracies = state.accuracyHistory.slice(-50).map(d => d.accuracy);
                
                if (!charts.accuracy) {
                    charts.accuracy = new Chart(accuracyCtx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: '–¢–æ—á–Ω–æ—Å—Ç—å %',
                                data: accuracies,
                                borderColor: '#8b5cf6',
                                backgroundColor: 'rgba(139, 92, 246, 0.1)',
                                borderWidth: 2,
                                fill: true,
                                tension: 0.4
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { display: false }
                            },
                            scales: {
                                x: { display: false },
                                y: {
                                    min: 0,
                                    max: 100,
                                    grid: { color: 'rgba(255,255,255,0.1)' },
                                    ticks: { color: '#94a3b8' }
                                }
                            }
                        }
                    });
                } else {
                    charts.accuracy.data.labels = labels;
                    charts.accuracy.data.datasets[0].data = accuracies;
                    charts.accuracy.update('none');
                }
            }
        }

        // ==================== –°–û–•–†–ê–ù–ï–ù–ò–ï/–ó–ê–ì–†–£–ó–ö–ê ====================
        async function saveModel() {
            showLoader(true, '–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏...');
            try {
                if (model) {
                    await model.save('localstorage://neuro-trader-model');
                }
                
                localStorage.setItem(CONFIG.MODEL_KEY, JSON.stringify({
                    balance: state.balance,
                    predictions: state.predictions.slice(-100),
                    balanceHistory: state.balanceHistory.slice(-50),
                    accuracyHistory: state.accuracyHistory.slice(-50),
                    savedAt: Date.now()
                }));
                
                addLog('–ú–æ–¥–µ–ª—å –∏ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã', 'info');
                showNotification('–ú–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ', 'info');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', error);
                addLog('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–∏', 'warning');
            } finally {
                showLoader(false);
            }
        }

        async function loadModel() {
            showLoader(true, '–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏...');
            try {
                // –ü—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –º–æ–¥–µ–ª—å
                const models = await tf.io.listModels();
                if (models['localstorage://neuro-trader-model']) {
                    model = await tf.loadLayersModel('localstorage://neuro-trader-model');
                    addLog('–ú–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏–∑ –ø–∞–º—è—Ç–∏', 'info');
                }
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
                const saved = localStorage.getItem(CONFIG.MODEL_KEY);
                if (saved) {
                    const data = JSON.parse(saved);
                    state.balance = data.balance || CONFIG.INITIAL_BALANCE;
                    state.predictions = data.predictions || [];
                    state.balanceHistory = data.balanceHistory || [{time: Date.now(), balance: state.balance}];
                    state.accuracyHistory = data.accuracyHistory || [];
                    
                    updateUI();
                    updateCharts();
                    updateIndicatorsTable();
                    
                    addLog('–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã', 'info');
                    showNotification('–ú–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ', 'info');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
                addLog('–ú–æ–¥–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é', 'warning');
            } finally {
                showLoader(false);
            }
        }

        // ==================== –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô ====================
        function initEventHandlers() {
            // –°—Ç–∞—Ä—Ç
            document.getElementById('startBtn').addEventListener('click', async () => {
                if (state.status === 'running') return;
                
                if (!model) {
                    model = await createModel();
                    if (!model) return;
                }
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                const symbol = document.getElementById('symbolSelect').value;
                const interval = document.getElementById('timeframeSelect').value;
                const data = await fetchData(symbol, interval, 100);
                
                if (data && data.length > 0) {
                    state.priceData = calculateIndicators(data);
                    state.sessionStart = Date.now();
                    state.status = 'running';
                    
                    document.getElementById('startBtn').disabled = true;
                    document.getElementById('pauseBtn').disabled = false;
                    
                    addLog('–û–±—É—á–µ–Ω–∏–µ –Ω–∞—á–∞—Ç–æ', 'info');
                    showNotification('–ù–µ–π—Ä–æ—Å–µ—Ç—å –Ω–∞—á–∞–ª–∞ –æ–±—É—á–µ–Ω–∏–µ', 'info');
                    
                    mainLoop();
                }
            });
            
            // –ü–∞—É–∑–∞
            document.getElementById('pauseBtn').addEventListener('click', () => {
                if (state.status === 'running') {
                    state.status = 'paused';
                    document.getElementById('pauseBtn').textContent = '‚ñ∂ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å';
                    addLog('–û–±—É—á–µ–Ω–∏–µ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ', 'warning');
                } else if (state.status === 'paused') {
                    state.status = 'running';
                    document.getElementById('pauseBtn').textContent = '‚è∏ –ü–∞—É–∑–∞';
                    addLog('–û–±—É—á–µ–Ω–∏–µ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–æ', 'info');
                    mainLoop();
                }
            });
            
            // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
            document.getElementById('saveBtn').addEventListener('click', saveModel);
            
            // –ó–∞–≥—Ä—É–∑–∏—Ç—å
            document.getElementById('loadBtn').addEventListener('click', loadModel);
            
            // –°–±—Ä–æ—Å
            document.getElementById('resetBtn').addEventListener('click', () => {
                if (confirm('–°–±—Ä–æ—Å–∏—Ç—å –º–æ–¥–µ–ª—å –∏ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ?')) {
                    model = null;
                    state = {
                        status: 'stopped',
                        balance: CONFIG.INITIAL_BALANCE,
                        predictions: [],
                        priceData: [],
                        balanceHistory: [{time: Date.now(), balance: CONFIG.INITIAL_BALANCE}],
                        accuracyHistory: [],
                        sessionStart: null,
                        indicators: {},
                        lastPrediction: null
                    };
                    
                    document.getElementById('startBtn').disabled = false;
                    document.getElementById('pauseBtn').disabled = true;
                    document.getElementById('pauseBtn').textContent = '‚è∏ –ü–∞—É–∑–∞';
                    
                    updateUI();
                    updateCharts();
                    updateIndicatorsTable();
                    
                    addLog('–°–∏—Å—Ç–µ–º–∞ —Å–±—Ä–æ—à–µ–Ω–∞', 'warning');
                    showNotification('–°–∏—Å—Ç–µ–º–∞ —Å–±—Ä–æ—à–µ–Ω–∞', 'info');
                }
            });
            
            // –û—á–∏—Å—Ç–∫–∞ –ª–æ–≥–∞
            document.getElementById('clearLogBtn').addEventListener('click', () => {
                document.getElementById('logContent').innerHTML = '';
                addLog('–õ–æ–≥ –æ—á–∏—â–µ–Ω', 'info');
            });
            
            // –í–∫–ª–∞–¥–∫–∏
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –≤–∫–ª–∞–¥–æ–∫
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º —Ç–µ–∫—É—â—É—é –≤–∫–ª–∞–¥–∫—É
                    tab.classList.add('active');
                    const tabId = tab.getAttribute('data-tab');
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                });
            });
            
            // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –≤–≤–µ—Ä—Ö
            document.getElementById('scrollTopBtn').addEventListener('click', () => {
                window.scrollTo({top: 0, behavior: 'smooth'});
            });
            
            // –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É
            window.addEventListener('scroll', () => {
                const btn = document.getElementById('scrollTopBtn');
                btn.style.display = window.scrollY > 300 ? 'flex' : 'none';
            });
        }

        // ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================
        async function init() {
            console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã...');
            addLog('–°–∏—Å—Ç–µ–º–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è', 'info');
            
            showLoader(true, '–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...');
            
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º TensorFlow.js
                if (!tf) {
                    throw new Error('TensorFlow.js –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
                }
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
                initEventHandlers();
                
                // –ü—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å
                await loadModel();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º UI
                updateUI();
                updateIndicatorsTable();
                
                addLog('–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ', 'info');
                showNotification('–ù–µ–π—Ä–æ—Å–µ—Ç—å-—Ç—Ä–µ–π–¥–µ—Ä –≥–æ—Ç–æ–≤–∞', 'info');
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
                addLog('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: ' + error.message, 'warning');
            } finally {
                showLoader(false);
            }
        }

        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>